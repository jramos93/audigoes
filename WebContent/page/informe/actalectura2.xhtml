<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions">

	<h:form id="frmConvocatoriaActa">
		<p:panel rendered="#{informeMB.status eq 'ACTA_LECTURA'}">
			<br />
			<br />
			<div align="left" style="margin-top: 50px; float: left;">
				<p:commandButton id="btnCancel" action="#{informeMB.onCancel}"
					styleClass="pink-btn raised-btn" process="@this" value="Regresar"
					icon="pi pi-arrow-left" style="float:left;"
					update=":frmConvocatoriaActa :frm">
				</p:commandButton>
			</div>
			<p:tabView style="margin-top:100px;">
				<p:tab title="Convocatoria">
					<p:panel>
						<div align="left" style="float: left;">
							<p:commandButton id="btn" value="Guardar" icon="fa fa-check"
								styleClass="raised-btn" rendered="#{convocatoriaMB.registro.cvcEstado eq 0}"
								actionListener="#{convocatoriaMB.onSave}"
								update=":frmInforme, :frm" />
							<p:commandButton id="enviar" value="Realizar Convocatoria"
								icon="pi pi-calendar" styleClass="raised-btn"
								rendered="#{convocatoriaMB.registro.cvcEstado eq 0}"
								oncomplete="PF('wvCorreoConvocatoria').show();"
								actionListener="#{convocatoriaMB.onPrepararEnvio}"
								update=":frmCorreoConvocatoria">
							</p:commandButton>
						</div>
						<div align="right" style="float: right;">
							<p:commandButton id="btnConvocatoria"
								title="Clic para generar la convocatoria"
								process="@this tvConvocatoria" value="Generar Formato de Convocatoria"
								icon="pi pi-check-circle" style="float:Righ;"
								styleClass="blue-btn raised-btn"
								oncomplete="PF('wvPDF').show();"
								actionListener="#{convocatoriaMB.onGenerarConvocatoria}">
							</p:commandButton>
						</div>
						<div class="name" align="center" style="margin-top: 50px;">
							<span class="app-name">Convocatoria de Lectura a Borrador
								de Informe de Auditoría:</span>
							<h3>Auditoría:
								#{informeMB.auditoria.audCodigo}-#{informeMB.auditoria.audNombre}</h3>
						</div>
						<br />


						<div class="ui-fluid p-formgrid p-grid">
							<div class="p-field p-col" style="margin-top: 25px;">
								<p:panel>
									<p:tabView id="tvConvocatoria" orientation="top">

										<p:tab title="Contenido">
											<pe:ckEditor id="cvccuerpo" width="100%" skin="office2013"
												height="500px"
												customConfig="#{request.contextPath}/resources/js/customck.js"
												value="#{convocatoriaMB.registro.cvcCuerpo}" />
										</p:tab>
										<p:tab title="Convocatorias Firmadas">
											<p:panelGrid columns="1" columnClasses="ui-g-12"
												layout="grid"
												styleClass="ui-panelgrid-blank form-group form-elements">
												<h:outputText value="Subida de archivos:"></h:outputText>
												<p:fileUpload listener="#{convocatoriaMB.handleFileUpload}"
													multiple="true" mode="advanced" dragDropSupport="false"
													cancelLabel="Cancelar" uploadLabel="Subir" label="Elegir"
													update="dtArchivos"
													allowTypes="/(\.|\/)(gif|jpe?g|png|doc|docx|xls|xlsx|pdf|ppt|pptx)$/" />
											</p:panelGrid>
											<p:dataTable var="a" value="#{arcMB.listado}"
												rowIndexVar="index" widgetVar="wvArchivos" reflow="true"
												id="dtArchivos" style="margin-top:20px;" paginator="true"
												paginatorPosition="top" rowsPerPageTemplate="1,5,10,15"
												rows="5"
												paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
												currentPageReportTemplate="{startRecord}-{endRecord} de {totalRecords} registros"
												rowKey="#{a.arcId}">

												<p:column headerText="No.">
													<h:outputText value="#{index+1}"></h:outputText>
												</p:column>

												<p:column headerText="Nombre" filterBy="#{a.arcNombre}"
													filterMatchMode="contains">
													<h:outputText value="#{a.arcNombre}"></h:outputText>
												</p:column>

												<p:column headerText="Ver"
													style="width:60px; text-align:center;">
													<p:commandButton actionListener="#{arcMB.viewFile}"
														icon="pi pi-eye" oncomplete="PF('wvPDF').show();"
														title="Clic para ver el archivo">
														<f:attribute name="pt" value="#{a}"></f:attribute>
													</p:commandButton>
												</p:column>

												<p:column headerText="Descargar"
													style="width:60px; text-align:center;">
													<p:commandButton actionListener="#{arcMB.downloadFile}"
														ajax="false" icon="pi pi-download"
														title="Clic para descargar el archivo">
														<f:attribute name="pt" value="#{a}"></f:attribute>
														<p:fileDownload value="#{arcMB.pt}"></p:fileDownload>
													</p:commandButton>
												</p:column>

												<p:column headerText="Eliminar" style="width:60px;">
													<p:commandButton actionListener="#{arcMB.onBorrar(a)}"
														update="dtArchivos" icon="pi pi-trash"
														title="Clic para eliminar el archivo">
														<p:confirm header="Confirmación" message="¿Eliminar?"
															icon="pi pi-info-circle"></p:confirm>
													</p:commandButton>
												</p:column>
											</p:dataTable>
										</p:tab>
									</p:tabView>
								</p:panel>
								<p:panelGrid columns="2"
									columnClasses="ui-g-9 ui-lg-10,ui-g-3 ui-md-4 ui-lg-2"
									layout="grid"
									styleClass="ui-panelgrid-blank form-group form-elements">
									<p:column></p:column>
									<p:commandButton id="btn3" value="Guardar" icon="fa fa-check"
										styleClass="raised-btn"
										actionListener="#{convocatoriaMB.onSave}"
										update=":frmInforme, :frm" />
								</p:panelGrid>
							</div>
						</div>
					</p:panel>
				</p:tab>
				<p:tab title="Acta de Lectura" disabled="#{convocatoriaMB.registro.cvcEstado eq 0}">
					<p:panel>
						<div align="left" style="float: left;">
							<p:commandButton id="btn2" value="Guardar" icon="fa fa-check"
								styleClass="raised-btn" actionListener="#{actaLecturaMB.onSave}"
								update=":frmInforme, :frm" />
							<p:commandButton id="inicio" value="Iniciar Lectura"
								icon="pi pi-info-circle" styleClass="raised-btn"
								actionListener="#{actaLecturaMB.onIniciar}"
								update=":frmInforme, :frm">
								<p:confirm header="Confirmación"
									message="¿Iniciar Reunión de Lectura de Borrador de Informe?"
									icon="pi pi-info"></p:confirm>
							</p:commandButton>
						</div>
						<div align="right" style="float: right;">
							<p:commandButton id="btnActa" oncomplete="PF('wvPDF').show();"
								actionListener="#{actaLecturaMB.onGenerarActa}"
								title="Clic para generar Acta de Lectura"
								process="@this tvActaLectura" value="Generar Acta de Lectura"
								icon="pi pi-check-circle" style="float:Righ;"
								styleClass="blue-btn raised-btn">
							</p:commandButton>
						</div>
						<div class="name" align="center" style="margin-top: 50px;">
							<span class="app-name">Acta de Lectura a Borrador de
								Informe de Auditoría:</span>
							<h3>Auditoría:
								#{informeMB.auditoria.audCodigo}-#{informeMB.auditoria.audNombre}</h3>
						</div>
						<br />
						<div class="ui-fluid p-formgrid p-grid">
							<div class="p-field p-col" style="margin-top: 25px;">
								<p:tab title="Acta lectura">
									<div class="ui-fluid p-formgrid p-grid">
										<p:tabView id="tvActaLectura">

											<p:tab title="Contenido">
												<pe:ckEditor id="aclcuerpo" width="100%" skin="office2013"
													height="450px"
													customConfig="#{request.contextPath}/resources/js/customck.js"
													value="#{actaLecturaMB.registro.aclCuerpo}" />
											</p:tab>
											<p:tab title="Actas Firmadas">
												<p:panelGrid columns="1" columnClasses="ui-g-12"
													layout="grid"
													styleClass="ui-panelgrid-blank form-group form-elements">
													<h:outputText value="Subida de archivos:"></h:outputText>
													<p:fileUpload listener="#{actaLecturaMB.handleFileUpload}"
														multiple="true" mode="advanced" dragDropSupport="false"
														cancelLabel="Cancelar" uploadLabel="Subir" label="Elegir"
														update="dtArchivos"
														allowTypes="/(\.|\/)(gif|jpe?g|png|doc|docx|xls|xlsx|pdf|ppt|pptx)$/" />
												</p:panelGrid>
												<p:dataTable var="a" value="#{arcMB.listado}"
													rowIndexVar="index" widgetVar="wvArchivos" reflow="true"
													id="dtArchivos" style="margin-top:20px;" paginator="true"
													paginatorPosition="top" rowsPerPageTemplate="1,5,10,15"
													rows="5"
													paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
													currentPageReportTemplate="{startRecord}-{endRecord} de {totalRecords} registros"
													rowKey="#{a.arcId}">

													<p:column headerText="No.">
														<h:outputText value="#{index+1}"></h:outputText>
													</p:column>

													<p:column headerText="Nombre" filterBy="#{a.arcNombre}"
														filterMatchMode="contains">
														<h:outputText value="#{a.arcNombre}"></h:outputText>
													</p:column>

													<p:column headerText="Ver"
														style="width:60px; text-align:center;">
														<p:commandButton actionListener="#{arcMB.viewFile}"
															icon="pi pi-eye" oncomplete="PF('wvPDF').show();"
															title="Clic para ver el archivo">
															<f:attribute name="pt" value="#{a}"></f:attribute>
														</p:commandButton>
													</p:column>

													<p:column headerText="Descargar"
														style="width:60px; text-align:center;">
														<p:commandButton actionListener="#{arcMB.downloadFile}"
															ajax="false" icon="pi pi-download"
															title="Clic para descargar el archivo">
															<f:attribute name="pt" value="#{a}"></f:attribute>
															<p:fileDownload value="#{arcMB.pt}"></p:fileDownload>
														</p:commandButton>
													</p:column>

													<p:column headerText="Eliminar" style="width:60px;">
														<p:commandButton actionListener="#{arcMB.onBorrar(a)}"
															update="dtArchivos" icon="pi pi-trash"
															title="Clic para eliminar el archivo">
															<p:confirm header="Confirmación" message="¿Eliminar?"
																icon="pi pi-info-circle"></p:confirm>
														</p:commandButton>
													</p:column>
												</p:dataTable>
											</p:tab>
										</p:tabView>
										<p:commandButton id="btnGuardarBottom1"
											action="#{actaLecturaMB.onSave}" value="Guardar"
											update="@form" process="@this tvActaLectura" />
									</div>
								</p:tab>
							</div>
						</div>
					</p:panel>
				</p:tab>
			</p:tabView>
		</p:panel>
	</h:form>

	<p:dialog widgetVar="wvCorreoConvocatoria" modal="true"
		showEffect="fade" maximizable="true" dynamic="true" closable="true"
		closeOnEscape="true" responsive="true">
		<h:form id="frmCorreoConvocatoria">
			<p:tabView>
				<p:tab title="Redacción de Correo">
					<p:commandButton id="btnEnviar" action="#{convocatoriaMB.onEnviar}"
						title="Clic para comunicar a la unidad"
						process=":frmCorreoConvocatoria" value="Comunicar a Unidad"
						icon="pi pi-check-circle" style="float:left;"
						styleClass="blue-btn raised-btn"
						oncomplete="if (args &amp;&amp; !args.validationFailed) PF('wvCorreoConvocatoria').hide();"
						update=":frmInforme, :frm, :frmCorreoConvocatoria">
						<p:confirm header="Confirmación" message="¿Comunicar a Unidad?"></p:confirm>
					</p:commandButton>
					<br/>
					<br/>
					<p:panelGrid columns="2" columnClasses="ui-g-6" layout="grid"
						styleClass="ui-panelgrid-blank form-group form-elements">
						<p:outputLabel for="responsable"
							value="Seleccione la(s) persona(s) a comunicar: "
							style="font-weight:bold;" />
						<p:selectCheckboxMenu id="responsable"
							value="#{convocatoriaMB.selectedUsuariosList}"
							converter="usuConverter" required="true" style="width: 20rem"
							multiple="true" panelStyle="width: 20rem" scrollHeight="150"
							title="Seleccione la(s) persona(s)" filter="true"
							filterMatchMode="contains">
							<f:selectItems value="#{convocatoriaMB.usuariosList}" var="usu"
								itemDescription="#{usu.usuCargo} - #{usu.usuCorreo}"
								itemLabel="#{usu.usuNombre} #{usu.usuApellido}"
								itemValue="#{usu}" />
						</p:selectCheckboxMenu>
					</p:panelGrid>
					<p:panelGrid columns="1" columnClasses="ui-g-12" layout="grid"
						styleClass="ui-panelgrid-blank form-group form-elements">
						<pe:ckEditor id="narra4" width="100%" height="250"
							value="#{convocatoriaMB.textoCorreo}" skin="office2013"
							customConfig="#{request.contextPath}/resources/js/customck.js" />
					</p:panelGrid>
				</p:tab>
				<p:tab title="Adjunto Documento Firmado">
					<p:fieldset>
						<h:outputText
							value="Seleccione el documento que desea que sea adjuntado en el correo, 
							puede adjuntar otro documento en caso sea necesario"></h:outputText>
					</p:fieldset>
					<p:panelGrid columns="1" columnClasses="ui-g-12" layout="grid"
						styleClass="ui-panelgrid-blank form-group form-elements">
						<h:outputText value="Subida de archivos:"></h:outputText>
						<p:fileUpload listener="#{convocatoriaMB.handleFileUpload}"
							multiple="true" mode="advanced" dragDropSupport="false"
							cancelLabel="Cancelar" uploadLabel="Subir" label="Elegir"
							update="dtArchivos"
							allowTypes="/(\.|\/)(gif|jpe?g|png|doc|docx|xls|xlsx|pdf|ppt|pptx)$/" />
					</p:panelGrid>
					<p:dataTable var="a" value="#{arcMB.listado}" rowIndexVar="index"
						widgetVar="wvArchivos" reflow="true" id="dtArchivos"
						style="margin-top:20px;" paginator="true" paginatorPosition="top"
						rowsPerPageTemplate="1,5,10,15" rows="5"
						selection="#{arcMB.regSelected}"
						paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
						currentPageReportTemplate="{startRecord}-{endRecord} de {totalRecords} registros"
						rowKey="#{a.arcId}">

						<p:column selectionMode="single"
							style="width:16px;text-align:center" />

						<p:column headerText="No.">
							<h:outputText value="#{index+1}"></h:outputText>
						</p:column>

						<p:column headerText="Nombre" filterBy="#{a.arcNombre}"
							filterMatchMode="contains">
							<h:outputText value="#{a.arcNombre}"></h:outputText>
						</p:column>

						<p:column headerText="Ver" style="width:60px; text-align:center;">
							<p:commandButton actionListener="#{arcMB.viewFile}"
								icon="pi pi-eye" oncomplete="PF('wvPDF').show();"
								title="Clic para ver el archivo">
								<f:attribute name="pt" value="#{a}"></f:attribute>
							</p:commandButton>
						</p:column>

						<p:column headerText="Descargar"
							style="width:60px; text-align:center;">
							<p:commandButton actionListener="#{arcMB.downloadFile}"
								ajax="false" icon="pi pi-download"
								title="Clic para descargar el archivo">
								<f:attribute name="pt" value="#{a}"></f:attribute>
								<p:fileDownload value="#{arcMB.pt}"></p:fileDownload>
							</p:commandButton>
						</p:column>

						<p:column headerText="Eliminar" style="width:60px;">
							<p:commandButton actionListener="#{arcMB.onBorrar(a)}"
								update="dtArchivos" icon="pi pi-trash"
								title="Clic para eliminar el archivo">
								<p:confirm header="Confirmación" message="¿Eliminar?"
									icon="pi pi-info-circle"></p:confirm>
							</p:commandButton>
						</p:column>
					</p:dataTable>
				</p:tab>
			</p:tabView>


		</h:form>
	</p:dialog>
</ui:composition>